const express = require('express');
const mysql = require('mysql2');
const cors = require('cors');
const bodyParser = require('body-parser');

const app = express();
const PORT = 7900;

// Enable CORS
app.use(cors());

// Parse incoming request bodies in a middleware before your handlers
app.use(bodyParser.json());

// MySQL Connection
const connection = mysql.createConnection({
    host: 'mysql-36e54173-mulberrydatabase.a.aivencloud.com',
    port: 24400,
    user: 'avnadmin',
    password: 'AVNS_PXPi8DwKVq_UOKMdt1m',
    database: 'defaultdb',
// Define a sample route
});

connection.connect((err) => {
  if (err) {
    console.error('Error connecting to MySQL:', err);
    return;
  }
  console.log('Connected to MySQL database');
});

function runQuery() {
    
  const dynamicSQL = "insert into oi14_db (sl, Thailand_Male) values (89899, JSON_ARRAY(32316,32447,32463,33025,32176,32290,32307,33942,33946,33960,33971,34021,34022,34025,34045,32029,32030,32037,32056,32100,32138,32153,32178,32259,32266,32282,32284,32295,32301,32322,32374,32378,32400,32425,32440,32442,32518,32598,32618,32762,32800,32806,32944,33042,33066,33132,33148,33177,33189,33260,33380,33395,33397,33500,33524,33525,33530,33544,33578,33608,33638,33725,33728,33774,33781,33802,33806,33848,33873,33949,33959,33993,33998,34015,34048,34055,34060,34097,32068,32113,32116,32233,32433,32470,32578,33762,33958,34092,31940,32027,32054,32085,32112,32860,32899,32900,32915,32922,32926,32934,32954,32983,33044,33050,33063,33096,33156,33183,33204,33252,33287,33375,33386,33394,33534,33590,33655,33771,33800,33877,33892,33897,33905,33915,33953,33965,32035,32080,32202,32430,32520,32667,32708,32796,33524,33626,33648,33668,33696,32912,32948,33076,33084,33089,33103,33122,33368,31991,32055,32123,32204,32245,32248,32289,32326,32413,32486,32553,32827,32871,32953,32956,32985,32999,33283,33311,33312,33343,33376,33585,33622,33646,33679,34060,32706,32035,32365,32530,32701,32721,32911,33879,32005,33370,31958,32026,32030,32055,32136,32142,32149,32153,32155,32401,32462,32469,32199,32424,32587,32035,32068,32069,32297,32427,32610,32685,32870,32977,33514,33679,33841,34093,31955,32146,32152,32655,32671,32678,32700,32710,32714,32972,33007,33047,33051,33064,33116,33138,33322,33331,33333,33342,33347,33357,33358,33363,33387,33393,33406,33407,33419,33489,33490,33491,33582,33607,33623,33627,33650,33706,33715,33819,33824,33826,33868,33875,33882,33883,32506,33423,34076,32732,32838,32895,32932,33708,33542,33555,33557,33563,33566,33576,33580,33589,33591,33612,32096,32283,32318,32429,32880,32888,32922,32931,33128,33427,33436,33441,33465,33513,33772,33816,32075,32248,32340,32354,32403,32412,32528,32544,32758,32827,32907,32928,32985,33000,33349,33491,33629,34087,32079,32080,32107,32113,32123,32186,32224,32315,32372,32396,32599,32642,32931,32978,33024,33036,33247,31980,32189,32212,32220,32004,32028,32042,32062,32103,32112,32182,32204,32388,33463,31970,32006,32012,32362,32506,32520,32534,32540,32545,32550,32602,32665,32730,32780,32783,32794,32800,32824,32843,32871,32912,32913,32933,32946,32955,32983,32987,33003,33008,33026,33045,33050,33086,33087,33122,33692,33937,33947,31943,32030,32087,32099,32391,32426,32466,32471,32610,32620,33539,33568,31936,32013,32068,32480,32531,32577,32626,32640,32641,32653,32654,32664,32667,32680,32703,32733,32777,32796,32802,32889,32890,32938,32959,32966,32986,33002,33006,33224,33231,33414,33574,33825,33993,34020,34068,31949,31955,32685,32691,32706,32719,32729,32789,32798,32820,32827,33898,33926,33955,33985,33996,34039,34044,34045,34053,34072,34081,34089,32099,32100,32160,32172,32173,32181,32199,32255,32262,32381,32398,32401,32407,32409,32418,32456,32647,32648,32839,32849,32850,32852,32862,32896,32915,32920,33006,33014,33017,33157,33162,33173,33212,33216,33282,33293,33306,33340,33341,33847,33873,32075,32214,32788,32978,32981,32990,33003,33068,33097,33110,33118,33140,33215,33243,33268,33379,33402,33460,33476,33582,33637,33638,31941,31978,31979,32163,32616,32620,32627,32631,32633,32637,32645,32646,32664,32670,32677,32708,32726,32739,32777,32812,32875,32886,32898,32908,32963,32968,32985,33020,33023,33116,33173,33177,33551,33553,33572,33725,33732,33733,33740,33749,33760,33764,33769,33770,33772,33778,33790,33810,33814,33820,33827,33834,33849,33852,33875,33883,33893,33902,34038,33219,33444,34038,33024,33031,33044,33827,33825,34023,34079,32387,34088,31993,32027,32783,32920,32976,32257,32108,32430,32440,32444,32739,32806,32840,32847,32863,32875,32906,32938,33023,33191,33210,33214,33217,33262,33301,33337,33382,33849,34009,34030,34037,33789,33833,34073,34104,32680,32857,32902,32990,33485,33625,33644,33679,33719,33726,33749,33760,33786,33794,33795,33802,33804,33825,33827,32292,32320,32330,32386,32470,32478,32479,32485,32490,32577,32972,33018,33026,32207,32212,32550,33243,33564,32699,32065,32117,32303,32306,33233,33257,33273,33308,33424,33466,33489,33138,32467,32468,32787,33180,33212,33463,33475,32069,32115,32327,32364,32454,32458,32478,32481,32502,32506,32523,32543,32544,32566,32576,32614,32642,32662,32677,32766,33260,33525,33261,33334,33362,33178,31950,31958,31964,31972,31992,32021,32031,32043,32052,32059,32063,32069,32073,32244,32288,32365,32375,33602,33610,32423,32922,32929,32937,32967,32975,32976,33939,33953,33955,33974,34011,34031,34057,34079,33205,33848,33855,33867,33503,33505,33514,32063,32212,32334,32158,32160,32161,32183,32186,32187,32196,32293,32332,32333,32346,32382,32396,32399,32404,32412,32471,32485,32491,32494,32497,32559,32571,32606,32625,32645,32665,32681,32683,32687,32693,32706,32768,32963,32972,32973,32978,32993,33002,33003,33044,33070,33082,33086,33095,33101,33117,33118,33127,33131,33158,33186,33205,33298,33318,33438,33490,33500,33501,33539,32029,32036,32376,33552,33790,32072,32149,32372,32565,32628,32673,32748,32767,32858,32900,32925,32931,33167,33239,33348,33427,33480,33532,33535,33553,33570,33697,33761,33775,33790,33984,34022,34069,34084,34087,32293,32319,32350,32435,32436,32576,32621,32655,32663,32673,32775,32792,32795,32820,32821,32893,32910,32990,32996,33077,33106,33157,33193,33273,33301,33312,33331,32127,33450,32132,33285,31970,32060,32125,32215,32362,32526,32548,32639,32669,32804,32876,33063,33891,32489,32498,32027,32036,32196,32224,32566,32586,32706,32848,32934,33181,33352,33621,33642,33705,33726,33808,33820,33831,33834,33839,33992,33263,33412,33413,33652,33717,32822,32827,32837,32877,32891,34095,32378,32567,32577,32609,32610,33342,33401,33613,33666,34053,32266,32443,33721,32260,32277,32019,32147,32153,32534,33108,33849,34009,34046,32470,32519,31992,32013,32031,32035,32054,32058,32384,32400,32408,32411,32059,32089,33809,33962,33997,34020,34025,34031,34102,32730,33250,33269,33276,33299,33303,33305,33314,33385,33441,33453,33460,33463,33470,33484,33528,33529,33591,33631,33663,33489,32112,32300,33131,33146,33326,33378,33444,33498,33683,34101,32604,32605,32670,32688,32719,32732,32737,32822,32695,32913,32933,33347,33348,33379,33385,33405,32978,32673,32692,33820,33862,33867,33890,34015,31945,31963,32019,32251,33103,31988,33509,33597,31955,32090,32123,32243,32270,32714,32869,33037,33064,33348,33379,33388,33815,33849,33861,33623,33897,33903,32069,32310,33447,33715,31943,31945,31947,32443,32444,33024,33136,33158,33231,33253,33282,33295,33842,33861,33867,33869,33881,33904,32267,32922,33113,33225,33231,33339,33466,33488,33549,32565,33812,33813,33817,32125,32175,32180,32238,32241,32324,32349,32351,33246,33425,33457,33504,33618,34093,32398,32402,32408,32429,32433,32434,32440,33124,33438,33747,32719,32903,32915,32967,32980,33405,31981,31989,32016,32037,32748,32971,33027,33079,33194,33579,33607,33769,33776,33906,34033,32853,32954,33827,33892,34028,32435,33136,33356,33631,33680,32085,32086,32180,32199,32233,32241,32316,32754,32773,33011,33185,33489,33508,33757,33926,33995,33649,33651,33653,33658,33705,33729,33804,33820,33823,34039,34045,32155,32242,32245,32248,32267,32270,32275,32276,32294,32295,32318,32373,32403,32435,32462,32468,32507,32509,32518,32537,32589,32599,32608,32614,32677,32680,32683,31983,32006,32016,32042,32248,32286,32319,32321,32323,32324,32347,32348,32359,32360,32378,32383,32394,32396,32403,32409,32418,32460,32463,32464,32493,32494,32572,32578,32580,32593,32603,32670,32682,32728,32747,32752,32757,32761,32767,32770,32775,32785,32786,32793,32794,32815,32832,32834,32842,32889,32899,32901,32908,32913,32951,32952,32968,32969,32982,32991,33007,33023,33050,33057,33062,33073,33122,33141,33182,33188,33200,33203,33206,33216,33277,33288,33293,33309,33315,33323,33327,33334,33366,33389,33395))"
    connection.query("select * from MULBERRY_DB where sl like '123%';", (error, result) => {
        if (error) {
            console.log("Error: ", error.message);
        } else {
            console.log("Result: ", result);
        }
    });
}


runQuery();

app.listen(PORT, () => {
    console.log(`Server is running on port ${PORT}`);
  });
  